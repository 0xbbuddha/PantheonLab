{
"lab" : {
    "hosts" : {
        "dc01" : {
            "hostname" : "kingslanding",
            "type" : "dc",
            "local_admin_password": "8dCT-DJjgScp",
            "domain" : "sevenkingdoms.local",
            "path" : "DC=sevenkingdoms,DC=local",
            "local_groups" : {
                "Administrators" : [
                    "sevenkingdoms\\robert.baratheon",
                    "sevenkingdoms\\cersei.lannister",
                    "sevenkingdoms\\DragonRider"
                ],
                "Remote Desktop Users" : [
                    "sevenkingdoms\\Small Council",
                    "sevenkingdoms\\Baratheon"
                ]
            },
            "scripts" : ["sidhistory.ps1"],
            "vulns" : ["disable_firewall", "adcs_esc10_case1", "adcs_esc10_case2"],
            "security": ["account_is_sensitive"],
            "security_vars": {
                "account_is_sensitive" : { "renly": {"account" : "renly.baratheon"} }
            }
        },
        "dc02" : {
            "hostname" : "winterfell",
            "type" : "dc",
            "local_admin_password": "NgtI75cKV+Pu",
            "domain" : "north.sevenkingdoms.local",
            "path" : "DC=north,DC=sevenkingdoms,DC=local",
            "local_groups" : {
                "Administrators" : [
                    "north\\eddard.stark",
                    "north\\catelyn.stark",
                    "north\\robb.stark"
                ],
                "Remote Desktop Users" : [
                    "north\\Stark"
                ]
            },
            "scripts" : [
                "asrep_roasting.ps1",
                "constrained_delegation_use_any.ps1",
                "constrained_delegation_kerb_only.ps1",
                "ntlm_relay.ps1",
                "responder.ps1",
                "gpo_abuse.ps1",
                "rdp_scheduler.ps1"
            ],
            "vulns" : ["disable_firewall","directory", "credentials", "autologon", "files", "enable_llmnr", "enable_nbt-ns", "shares"],
            "vulns_vars" : {
                "directory": {
                    "setup": "c:\\setup"
                },
                "credentials" : {
                    "TERMSRV/castelblack": {
                        "username" : "north\\robb.stark",
                        "secret"   : "sexywolfy",
                        "runas"    : "north\\robb.stark",
                        "runas_password" : "sexywolfy"
                    }
                },
                "autologon" : {
                    "robb.stark" : {
                        "username" : "north\\robb.stark",
                        "password" : "sexywolfy"
                    }
                },
                "files" : {
                    "rdp" : {
                        "src" : "dc02/bot_rdp.ps1",
                        "dest" : "c:\\setup\\bot_rdp.ps1"
                    },
                    "sysvol_fake_script": {
                        "src" : "dc02/sysvol_scripts/script.ps1",
                        "dest": "C:\\Windows\\SYSVOL\\domain\\scripts\\script.ps1"
                    },
                    "sysvol_secret": {
                        "src" : "dc02/sysvol_scripts/secret.ps1",
                        "dest": "C:\\Windows\\SYSVOL\\domain\\scripts\\secret.ps1"
                    }
                }
            }
        }
    },
    "domains" : {
        "essos.local" : {
            "dc": "dc03",
            "domain_password" : "Ufe-bVXSx9rk",
            "netbios_name": "ESSOS",
            "ca_server": "Braavos",
            "trust" : "sevenkingdoms.local",
            "laps_path": "OU=Laps,DC=essos,DC=local",
            "organisation_units" : {
            },
            "laps_readers": [
                "jorah.mormont",
                "Spys"
            ],
            "groups" : {
                "universal" : {
                    "greatmaster" : {
                        "path" : "CN=Users,DC=essos,DC=local"
                    }
                },
                "global" : {
                    "Targaryen" : {
                        "managed_by" : "viserys.targaryen",
                        "path" : "CN=Users,DC=essos,DC=local"
                    },
                    "Dothraki" : {
                        "managed_by" : "khal.drogo",
                        "path" : "CN=Users,DC=essos,DC=local"
                    },
                    "Dragons":{
                        "managed_by" : "Administrator",
                        "path" : "CN=Users,DC=essos,DC=local"
                    },
                    "QueenProtector":{
                        "managed_by" : "Administrator",
                        "path" : "CN=Users,DC=essos,DC=local",
                        "members" : ["ESSOS\\Dragons"]
                    },
                    "Domain Admins":{
                        "managed_by" : "Administrator",
                        "path" : "CN=Users,DC=essos,DC=local",
                        "members" : ["ESSOS\\QueenProtector"]
                    }
                },
                "domainlocal" : {
                    "DragonsFriends" : {
                        "managed_by" : "daenerys.targaryen",
                        "path" : "CN=Users,DC=essos,DC=local"
                    },
                    "Spys" : {
                        "path" : "CN=Users,DC=essos,DC=local"
                    }
                }
            },
            "multi_domain_groups_member" : {
                "DragonsFriends" : [
                    "sevenkingdoms.local\\tyron.lannister",
                    "essos.local\\daenerys.targaryen"
                ],
                "Spys" : [
                    "sevenkingdoms.local\\Small Council"
                ]
            },
            "gmsa" : {
                "gmsa_account": {
                    "gMSA_Name" : "gmsaDragon",
                    "gMSA_FQDN" : "gmsaDragon.essos.local",
                    "gMSA_SPNs" : ["HTTP/braavos", "HTTP/braavos.essos.local"],
                    "gMSA_HostNames" : ["braavos"]
                }
            },
            "acls" : {
                "GenericAll_khal_viserys" : {"for": "khal.drogo", "to": "viserys.targaryen", "right": "GenericAll", "inheritance": "None"},
                "GenericAll_spy_jorah" : {"for": "Spys", "to": "jorah.mormont", "right": "GenericAll", "inheritance": "None"},
                "GenericAll_khal_esc4" : {"for": "khal.drogo", "to": "CN=ESC4,CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=essos,DC=local", "right": "GenericAll", "inheritance": "None"},
                "WriteProperty_petyer_domadmin" : {"for": "viserys.targaryen", "to": "jorah.mormont", "right": "WriteProperty", "inheritance": "All"},
                "GenericWrite_DragonsFriends_braavos" : {"for": "DragonsFriends", "to": "braavos$", "right": "GenericWrite", "inheritance": "None"},
                "GenericAll_missandei_khal" : {"for": "missandei", "to": "khal.drogo", "right": "GenericAll", "inheritance": "None"},
                "GenericAll_gmsaDragon_drogo" : {"for": "gmsaDragon$", "to": "drogon", "right": "GenericAll", "inheritance": "None"},
                "GenericWrite_missandei_viserys" : {"for": "missandei", "to": "viserys.targaryen", "right": "GenericWrite", "inheritance": "None"}
            },
            "users" : {
                "daenerys.targaryen" : {
                    "firstname"   : "daenerys",
                    "surname"     : "targaryen",
                    "password"    : "BurnThemAll!", 
                    "city"        : "-",
                    "description" : "Darnerys Targaryen",
                    "groups"      : ["Targaryen", "Domain Admins"],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "viserys.targaryen" : {
                    "firstname"   : "viserys",
                    "surname"     : "targaryen",
                    "password"    : "GoldCrown",
                    "city"        : "-",
                    "description" : "Viserys Targaryen",
                    "groups"      : ["Targaryen"],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "khal.drogo" : {
                    "firstname"   : "khal",
                    "surname"     : "drogo",
                    "password"    : "horse",
                    "city"        : "-",
                    "description" : "Khal Drogo",
                    "groups"      : ["Dothraki"],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "jorah.mormont" : {
                    "firstname"   : "jorah",
                    "surname"     : "mormont",
                    "password"    : "H0nnor!",
                    "city"        : "-",
                    "description" : "Jorah Mormont",
                    "groups"      : ["Targaryen"],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "missandei" : {
                    "firstname"   : "missandei",
                    "surname"     : "-",
                    "password"    : "fr3edom",
                    "city"        : "-",
                    "description" : "missandei",
                    "groups"      : [],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "drogon" : {
                    "firstname"   : "drogon",
                    "surname"     : "-",
                    "password"    : "Dracarys",
                    "city"        : "-",
                    "description" : "drogon",
                    "groups"      : ["Dragons"],
                    "path"        : "CN=Users,DC=essos,DC=local"
                },
                "sql_svc" : {
                    "firstname"   : "sql",
                    "surname"     : "service",
                    "password"    : "YouWillNotKerboroast1ngMeeeeee",
                    "city"        : "-",
                    "description" : "sql service",
                    "groups"      : [],
                    "path"        : "CN=Users,DC=essos,DC=local",
                    "spns"        : ["MSSQLSvc/braavos.essos.local:1433","MSSQLSvc/braavos.essos.local"]
                }
            }
        }
    }
}}
